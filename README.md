# RobotGL
Computer Graphics final project


## קבצים מצורפים

מצורף קובץ zip המכיל את המסמך הנוכחי, ואת התיקיה פרויקט המכילה בתוכה את כל הספריות עזר, קבצי עזר קוד הפרויקט המתועדים בהם כתובים הסברים בהערות לכל שגרה קובץ הexe ושאר הקבצים הדרושים להרצת התוכנית.

## צורת הרצה

מומלץ לפתוח את הפרויקט בVisual studio, לאחר הפתיחה יש ללחוץ על הקובץ .sln ואז להריץ את התוכנית  על X86.










## התוכנית

בתוכנית יש רובוט שנמצא במועדון ריקודים, עמדת דיג'יי, בועות סבון, מכונת בועות , חייזר, רמקולים, פסל של רובוט (כאשר בשלושת האובייקטים האחרונים נעשה שימוש במיפוי מרקם)
הרובוט יכול ללכת ולהסתובב ברחבי המועדון כאשר המשתמש שולט בו באמצעות המקלדת וגם יכול לראות את העולם מנקודת המבט של הרובוט, יכול לבצע רוטציות עם הזרוע בכתף, במרפק ובשורש כף היד וגם בראשו, כמו כן ניתן להפעיל מצב בו הוא רוקד, הוראות לשליטה מצורפים בתמונות הבאות:  



















ניתן לשנות את גודל התפריט על ידי לחיצה בפינה הימנית התחתונה שלו.

הצבעים של קירות המועדון והרצפה נבחרים בצורה רנדומלית בעת כל פתיחה של התוכנית (לכן הקירות והרצפה נראים שונים בכל תמונה).

במועדון יש 2 ספוטים (מקורות אור), אחד מרובע ואחד עגול. ניתן להזיז אותם מהתפריט משתמש, ולשנות את הכיוון והעוצמה.
כפי שניתן לראות בתמונה הבאה : 








(חלק מהתפריט השולט בתאורה)

בתכנית יש תפריט שבעזרתו המשתמש יכול לשלוט באלמנטים שונים בסביבה התלת מימדית למשל במיקום וכיוון המצלמה (גם באמצעות תפריט המשתמש וגם באמצעות גלגל העכבר ולחיצת ומשיכת העכבר בתוכנית) , בעוצמת התאורה הסביבתית (ambient), ניתן לעשות שיהיה הבהוב של אורות צבעוניים, 














ניתן לכבות/ להדליק מוזיקת רקע, להעביר למצב מסך מלא ועוד (קיים גם הסבר תחת הקטגוריה how to control the scene).









התפריט לפעמים קצת איטי וצריך ללחוץ על כפתור כמה פעמים עד שנפתח.
בנוסף לסגירת החלון הרגילה, ישנה אפשרות לצאת מהתוכנית דרך כפתור exit  (שימושי בעיקר כאשר נמצאים במצב מלא ולא רוצים אך כמובן ניתן להשתמש בכל מצב)










ספריות עזר

התוכנית כתובה בopenGL, נעשה שימוש בGLUT על מנת לרנדר את הסצנה. 

כדי לבצע את החישובים הגאומטרים השתמשנו ב[glm](https://glm.g-truc.net/0.9.9/index.html)  - ספריית החישובים המתמטיים של opengl.

את התפריט הכנו באמצעות [imgui](https://github.com/ocornut/imgui).

כדי להעלות את קבצי ה.obj השתמשנו בספרייה בשם [tiny object loader](https://github.com/tinyobjloader/tinyobjloader) 

עבור מוזיקת הרקע עשינו שימוש בספריית [SDL](https://github.com/libsdl-org/SDL/releases/tag/release-2.30.6).

מבנה הקוד

Floor – אחראי על רינדור הרצפה בעלת אריחים צבעוניים (הצבעים נבחרים בכל פעם בצורה רנדומליים בעזרת HEADER המכיל את הפונקציות [הקצרות מאוד] שגורמות לרנדומליות).

Wall – אחראי על רנדור הקירות, צבע הקירות נבחר בצורה רנדומלית (גם פה נעזרים בקובץ HEADER בדומה לרצפה).

Music – אחראית על הניגון של המוזיקה של המסיבה כשהמשתמש בוחר.

Particle & Particle System – אחראים על יצירת הבועות כמותת התנהגות, והמראה שלהם בסצנה.

Random Color – בעזרתו הרצפה וקירות מקבלים צבעים רנדומליים.

ObjectGL – בקובץ זה נשאבים עבור כל קובץ אובייקט שאיתחלנו בסצינה כל נתוני הקוארדינטות חומר – תאורה, הצללה (ומרקם אם יש)  דרך קובץ הOBJ שמכיל את קוארדינטות האובייקט וקישור לחומר האובייקט שנמצא בקובץ MTL המתאים, קובץ הMTL   לפעמים מכיל קישור לקובץ תמונה שממנו מתבצע מיפוי המרקם והופך את האובייקטים לזמינים עבור הפרויקט,

Robot – אחראי על יצירת הרובוט שהוא הדמות המרכזית עליה שולטים בפרוייקט, אחראי על רנדור הרובוט, הפונקציונליות של הרובוט (שליטה בגפיים, ובראש תזוזה ושינוי נקודת מבט לנקודת המבט של הרובוט).

Light – אחראית על התאורה בסצנה, במקרה שלנו אחראי על הפנס המרובע והעגול, מאפשר שינוי של העוצמה ,כיוון, צבע התאורה ומיקום של גופי התאורה.

Scene – אחראי על יצירת הסצנה וגם שינוי בסצנה שנעשים על ידי המשתמש, משם נעשות הקריאות לפונקציות השונות בפרוייקט.

מכיל את הפונקציה שיוצרת את התפריט משתמש ממה בין היתר מושפע העיצוב והמלל.

קובץ הMAIN של התוכנית יוצר מופע של Scene.

אלגוריתמים מרכזיים

נקודת מבט הרובוט (getViewVector):

אנחנו מחשבים את נקודת המבט של הרובוט על ידי המיקום הנוכחי שלו בשילוב הזווית אליו הראש שלו פונה (מוסיפים 5 בערך הY כדי שנקודת המבט לא תהיה בתוך הגוף של הרובוט), ואז משנים את ווקטור המצלמה לווקטור שמצאנו (Scene::display).










(נקודת מבט של הרובוט לכיוון חייזר ופסל רובוט)

סיבוב פנס לפי כיוון (מתבצע בפונקציה fixDirection):

המשתמש משנה את מיקום הפנס והכיוון שלו מתפריט המשתמש, ובהתאם לערכים החדשים אנחנו משנים את מיקום וכיוון הפנס.

מוצאים את הנורמל בין ווקטור כיוון אובייקט הפנס הנוכחי לבין ווקטור כיוון הפנס לאחר שינוי נקודת ההסתכלות שלו, מוצאים את הזווית בין הווקטורים ומסובבים את האובייקט סביב הנורמל בזווית המתאימה. וכך מתבצע הסיבוב שלו.

תזוזה וסיבוב של איברי של הרובוט:

בתהליך הרינדור הראשוני, קורדינטות המיקום ההתחלתיות של הרובוט נקבעות כך שראשית הצירים היא נקודת ההתחלה, והווקטור מייצג את הכיוון שאליו הרובוט פונה. איברי הרובוט נוצרים ביחס לערכים אלה ובהיררכיה ביניהם.
כאשר המשתמש לוחץ על מקש להזזת איבר מסוים, הערך של אותו איבר משתנה בהתאם לערכים הנוכחיים. אם הערך החדש נמצא בטווח המותר שהוגדר (כדי לשמור על ריאליסטיות), הוא מתעדכן והרובוט מרונדר עם הערכים החדשים. תהליך זה מתבצע באופן רציף ובמהירות, מה שנותן את האפקט של תנועה חלקה.
כאשר המשתמש מזיז את הרובוט כולו, הקורדינטות והווקטור מייצגי הכיוון מתעדכנים בהתאם, כך שבפעם הבאה שהרובוט מרונדר, הוא נמצא במיקום ובכיוון החדשים.
